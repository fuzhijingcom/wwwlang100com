!function(e){function t(a){if(r[a])return r[a].exports;var n=r[a]={exports:{},id:a,loaded:!1};return e[a].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var r={};return t.m=e,t.c=r,t.p="http://localhost:8080/dist/",t(0)}([function(e,t,r){function a(){var e=$("#inBatch"),t=$("#homeRelatedMod"),r=t.find("ul"),a=0,o=0,i=5,c=5,l={listType:"homeRelatedList",username:window.userName,memTypeId:window.memTypeId,supCat:encodeURIComponent(window.searchVal),areaName:encodeURIComponent(window.areaName)},s="http://detail.b2b.hc360.com/detail/turbine/action/ajax.SearchSupplyDetailAjaxAction/eventsubmit_doProdbysupply/doProdbysupply",p="hcdetail_enterpriselog=detail_recommend_sp";$.ajax({url:s,data:l,timeout:3e3,scriptCharset:"utf-8",dataType:"jsonp",jsonp:"jsoncallback"}).done(function(l){if(!l||1!==parseInt(l.success))return void t.hide();homeRelatedModDataDeferred.resolve(l.jsonP4pList||{});var s=l.jsonP4pList?l.jsonP4pList.searchResultInfo:[],u=l.productList.slice(s.length),d="";a=u.length+s.length;var h=a%i;o=0===h?a/i:a/i+1;for(var f=0;f<u.length;f++)if(f<15){var m=u[f],g=decodeURIComponent(m.title).replace(/\+/g," "),v=m.url,R=""!=m.price?"&yen;"+m.price:"\ufffd\ufffd\ufffd\ufffd",y=m.imgUrlBig,w=(n.prototype.parseURL(m.url)||{}).file,b=w?w.substr(0,w.indexOf(".")):"";d=d+"<li style=\"display:none\"><div class='picbox'><a href='"+v+"' data-exposurelog='"+userName+","+b+"' title='"+g+"'  target='_blank' onclick=\"return hcclick('?"+p+"');\"><img onload='resizeImg(this,150,150);' onerror='imgonerror(this)' src='"+y+"'/></a></div><p class='pay'>"+R+"</p><p class='txtoverf'><a href='"+v+"' title='"+g+"' target='_blank' onclick=\"return hcclick('?"+p+"');\">"+g+"</a></p></li>"}$.trim(d).length&&r.append(d),0!==$.trim(d).length||s.length?(t.show(),r.find("li").each(function(e){e<i&&$(this).show()}),r.find("li").length<=i&&e.hide()):t.hide(),e.bind("click",function(){r.find("li").each(function(e){var t=$(this);e<c+i&&e>=c?t.show():t.hide()}),c+=i,c=c>=a?0:c})}).fail(function(){t.hide()})}var n=r(2),o=new n({keyword:window.searchVal||$("title:eq(0)").text()||"",referrer:7,clickableElementSelector:"a",wrap:$("#ypBanner"),template:"",cache:window.p4pbclist||{},getClickElementCacheIndexCallback:function(e){return e.closest("li").data("index")}});o.addEventListener("onDataReady",function(e){for(var t=this,r=e||{},a=r.searchResultInfo||[],n=0;n<a.length;n++)a["bcid_"+(a[n].searchResultfoId||a[n].searchResultfoID).toString()]=n;t.wrap.find(".proTopRecomCon ul li").each(function(e,t){var r=$(t),n=parseInt(r.attr("data-p4p-bcid"))||0,o=a["bcid_"+n.toString()];n&&o>=0&&r.data({id:n,index:o}).attr("data-p4p-mark","")}),t.target=t.wrap.find("[data-p4p-mark]")}),o.addEventListener("onEndRender",function(e){e.on("click","a",function(){try{HC.UBA.sendUserlogsElement("UserBehavior_p4p_spsy")}catch(e){}})}),o.init(),$("#homeRelatedMod").length>0&&a(),window.homeRelatedModDataDeferred=$.Deferred(),$.when(homeRelatedModDataDeferred).done(function(e){var t=["{{each products as product i}}",'<li data-index="{{i}}" style="display:none">','<div class="picbox">','<a onclick="HC.UBA.sendUserlogsElement(&quot;UserBehavior_p4p_spsy_{{i+1}}_tupian&quot;)" onmousedown="HC.UBA.sendUserlogsElement(\'UserBehavior_supplyself_llb_2_{{i+1}}?detailbcid={{product.searchResultfoId}}\')" data-exposurelog="###gg_supplyself_llb_2_{{i+1}}?detailbcid={{product.searchResultfoId}}"  href="{{product.searchResultfoUrl}}" title="{{product.searchResultfoTitle}}" target="_blank">','<img src="{{product.searchResultfoImageBig}}">',"</a>","</div>",'<p class="pay">{{product.pretreatPrice}}</p>','<p class="txtoverf">','<a onclick="HC.UBA.sendUserlogsElement(&quot;UserBehavior_p4p_spsy_{{i+1}}_title&quot;)" href="{{product.searchResultfoUrl}}" title="{{product.searchResultfoTitle}}" target="_blank">{{product.searchResultfoTitle}}</a>',"</p>","</li>","{{/each}}"],r=new n({keyword:window.areaName||"",referrer:7,clickableElementSelector:"a,button",wrap:$("#relatetlist > ul"),template:t.join(""),cache:e||{},getClickElementCacheIndexCallback:function(e){return e.closest("[data-index]").attr("data-index")}});r.addEventListener("onEndRender",function(e){var t=this;t.resizeImage(e.find("img"),function(){return $(this).closest(".picbox")})}),r.init()})},function(e,t,r){var a;!function(){function n(e){return e.replace(k,"").replace(x,",").replace(_,"").replace(E,"").replace(I,"").split(C)}function o(e){return"'"+e.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function i(e,t){function r(e){return d+=e.split(/\n/).length-1,p&&(e=e.replace(/\s+/g," ").replace(/<!--[\w\W]*?-->/g,"")),e&&(e=m[1]+o(e)+m[2]+"\n"),e}function a(e){var r=d;if(s?e=s(e,t):i&&(e=e.replace(/\n/g,function(){return d++,"$line="+d+";"})),0===e.indexOf("=")){var a=u&&!/^=[=#]/.test(e);if(e=e.replace(/^=[=#]?|[\s;]*$/g,""),a){var o=e.replace(/\s*\([^\)]+\)/,"");v[o]||/^(include|print)$/.test(o)||(e="$escape("+e+")")}else e="$string("+e+")";e=m[1]+e+m[2]}return i&&(e="$line="+r+";"+e),w(n(e),function(e){if(e&&!h[e]){var t;t="print"===e?y:"include"===e?$:v[e]?"$utils."+e:R[e]?"$helpers."+e:"$data."+e,b+=e+"="+t+",",h[e]=!0}}),e+"\n"}var i=t.debug,c=t.openTag,l=t.closeTag,s=t.parser,p=t.compress,u=t.escape,d=1,h={$data:1,$filename:1,$utils:1,$helpers:1,$out:1,$line:1},f="".trim,m=f?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],g=f?"$out+=text;return $out;":"$out.push(text);",y="function(){var text=''.concat.apply('',arguments);"+g+"}",$="function(filename,data){data=data||$data;var text=$utils.$include(filename,data,$filename);"+g+"}",b="'use strict';var $utils=this,$helpers=$utils.$helpers,"+(i?"$line=0,":""),k=m[0],x="return new String("+m[3]+");";w(e.split(c),function(e){e=e.split(l);var t=e[0],n=e[1];1===e.length?k+=r(t):(k+=a(t),n&&(k+=r(n)))});var _=b+k+x;i&&(_="try{"+_+"}catch(e){throw {filename:$filename,name:'Render Error',message:e.message,line:$line,source:"+o(e)+".split(/\\n/)[$line-1].replace(/^\\s+/,'')};}");try{var E=new Function("$data","$filename",_);return E.prototype=v,E}catch(I){throw I.temp="function anonymous($data,$filename) {"+_+"}",I}}var c=function(e,t){return"string"==typeof t?$(t,{filename:e}):p(e,t)};c.version="3.0.0",c.config=function(e,t){l[e]=t};var l=c.defaults={openTag:"<%",closeTag:"%>",escape:!0,cache:!0,compress:!1,parser:null},s=c.cache={};c.render=function(e,t){return $(e,t)};var p=c.renderFile=function(e,t){var r=c.get(e)||y({filename:e,name:"Render Error",message:"Template not found"});return t?r(t):r};c.get=function(e){var t;if(s[e])t=s[e];else if("object"==typeof document){var r=document.getElementById(e);if(r){var a=(r.value||r.innerHTML).replace(/^\s*|\s*$/g,"");t=$(a,{filename:e})}}return t};var u=function(e,t){return"string"!=typeof e&&(t=typeof e,"number"===t?e+="":e="function"===t?u(e.call(e)):""),e},d={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},h=function(e){return d[e]},f=function(e){return u(e).replace(/&(?![\w#]+;)|[<>"']/g,h)},m=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},g=function(e,t){var r,a;if(m(e))for(r=0,a=e.length;a>r;r++)t.call(e,e[r],r,e);else for(r in e)t.call(e,e[r],r)},v=c.utils={$helpers:{},$include:p,$string:u,$escape:f,$each:g};c.helper=function(e,t){R[e]=t};var R=c.helpers=v.$helpers;c.onerror=function(e){var t="Template Error\n\n";for(var r in e)t+="<"+r+">\n"+e[r]+"\n\n";"object"==typeof console&&console.error(t)};var y=function(e){return c.onerror(e),function(){return"{Template Error}"}},$=c.compile=function(e,t){function r(r){try{return new o(r,n)+""}catch(a){return t.debug?y(a)():(t.debug=!0,$(e,t)(r))}}t=t||{};for(var a in l)void 0===t[a]&&(t[a]=l[a]);var n=t.filename;try{var o=i(e,t)}catch(c){return c.filename=n||"anonymous",c.name="Syntax Error",y(c)}return r.prototype=o.prototype,r.toString=function(){return o.toString()},n&&t.cache&&(s[n]=r),r},w=v.$each,b="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",k=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|\s*\.\s*[$\w\.]+/g,x=/[^\w$]+/g,_=new RegExp(["\\b"+b.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),E=/^\d[^,]*|,\d[^,]*/g,I=/^,+|,+$/g,C=/^$|,+/;l.openTag="{{",l.closeTag="}}";var D=function(e,t){var r=t.split(":"),a=r.shift(),n=r.join(":")||"";return n&&(n=", "+n),"$helpers."+a+"("+e+n+")"};l.parser=function(e){e=e.replace(/^\s/,"");var t=e.split(" "),r=t.shift(),a=t.join(" ");switch(r){case"if":e="if("+a+"){";break;case"else":t="if"===t.shift()?" if("+t.join(" ")+")":"",e="}else"+t+"{";break;case"/if":e="}";break;case"each":var n=t[0]||"$data",o=t[1]||"as",i=t[2]||"$value",l=t[3]||"$index",s=i+","+l;"as"!==o&&(n="[]"),e="$each("+n+",function("+s+"){";break;case"/each":e="});";break;case"echo":e="print("+a+");";break;case"print":case"include":e=r+"("+t.join(",")+");";break;default:if(/^\s*\|\s*[\w\$]/.test(a)){var p=!0;0===e.indexOf("#")&&(e=e.substr(1),p=!1);for(var u=0,d=e.split("|"),h=d.length,f=d[u++];h>u;u++)f=D(f,d[u]);e=(p?"=":"=#")+f}else e=c.helpers[r]?"=#"+r+"("+t.join(",")+");":"="+e}return e},a=function(){return c}.call(t,r,t,e),!(void 0!==a&&(e.exports=a))}()},function(e,t,r){function a(e){var t=this;$.extend(!0,t,{listener:{},service:{data:{url:"http://s.hc360.com/getmmtlast.cgi",data:{w:"",mc:"seller",sys:"ls",p4p:"1"},dataType:"jsonp",jsonp:"jsoncallback",timeout:3e3},click:{url:"http://p4pserver.org.hc360.com/p4pserver/doAnticheating",data:{},dataType:"jsonp",jsonp:"jsoncallback",cache:!1,timeout:3e3}},wrap:null,target:null,targetRenderCallback:function(e){return $(e).appendTo(t.wrap)},clickableElementSelector:"a,button",antiCheating:!0,cache:null,referrer:0,keyword:"",template:"",getClickElementCacheIndexCallback:function(e){return e.closest("li").index()},preventDefaultLinkRedirect:!1,preventDefaultLinkRedirectCallBack:function(e,t){},autoSendExpoData:!0,templateEngine:r(1)},e)}var n=$.Deferred();$(function(){n.resolve()}),a.prototype.init=function(){var e=this,t=e.getDataDeferred();"[object Function]"===Object.prototype.toString.call(e.wrap)&&(e.wrap=e.wrap.call(null)),$.when(t).done(function(t){e.__dispatchEvent("onDataReady",t),e.cache=t||{},e.cache.prolist=e.cache.searchResultInfo||[],0!==(e.cache.prolist||[]).length&&(e.render(),e.bindEvent(),e.autoSendExpoData&&n.done(function(){e.sendExpoData(e.cache.prolist)}))}).fail(function(){e.__dispatchEvent("onDataFail",arguments)})},a.prototype.render=function(){var e=this,t=e.template,r={products:e.cache.prolist||[]},a="";e.pretreatData(),e.__dispatchEvent("onStartRender",t,r),0!==$.trim(t).length&&(a=e.templateEngine.render(t)(r),e.target=e.targetRenderCallback&&e.targetRenderCallback.call(e,a)),e.__dispatchEvent("onEndRender",e.target)},a.prototype.pretreatData=function(){function e(e){for(var t,r=new RegExp("([^\\;\\:]+):([^\\;\\:]+)","ig"),a=[];t=r.exec(e);)a.push({name:t[1]||"",value:t[2]||""});return a}for(var t,r=this,a=new RegExp(r.keyword,"img"),n=0;n<r.cache.prolist.length;n++)t=r.cache.prolist[n],t.pretreatImage=t.searchResultfoImageBig.replace(/(?:\\.\\.)\.*/gi,"")||t.searchResultfoImageBig||"",t.pretreatIconText=0==t.searchResultfoIsRecomHQ?"\u63a8\u8350":1==t.searchResultfoIsRecomHQ?"\u4f18\u8d28":"",t.pretreatTitle=t.searchResultfoTitle.replace(a,"<span>"+r.keyword+"</span>"),t.pretreatAttrs=e(t.searchResultfoAttr||""),t.pretreatShopUrl="http://"+t.searchResultfoUserName+".b2b.hc360.com",t.pretreatPrice=0===parseFloat(t.searchResultfoUnitPrice)?"\u9762\u8bae":"&yen;"+t.searchResultfoUnitPrice+" &frasl;"+t.searchResultfoMeasureUnit,t.pretreatIsTrade=0!==parseFloat(t.searchResultfoUnitPrice)&&parseInt(t.searchResultfoTrading),t.pretreatMobilePhone=t.searchResultfoTelephone?searchResultfoTelephone:t.searchResultfoML,t.pretreatArea=t.searchResultfoZone.replace("\u4e2d\u56fd","").replace(/:/g," ")||"\u5546\u5bb6\u6682\u672a\u63d0\u4f9b"},a.prototype.getDataDeferred=function(){var e,t=this,r={};return t.__dispatchEvent("onStartGetData",r),t.cache?(e=$.Deferred(),e.resolve(t.cache)):e=t.sendHttpRequest("data",$.extend(!0,{},{data:{source:t.referrer,w:t.keyword}},r)),e},a.prototype.bindEvent=function(){var e=this;e.target&&e.target.on("click",e.clickableElementSelector,function(t){e.eventHandler.call(e,t)}),e.__dispatchEvent("onEndBindEvent",e.target)},a.prototype.eventHandler=function(e){var t=this,r=$(e.currentTarget),a=parseInt(t.getClickElementCacheIndexCallback.call(null,r))||0,n=t.cache.prolist[a];if(n){if(t.preventDefaultLinkRedirect&&e.preventDefault(),t.antiCheating&&n.clicked)return void(t.preventDefaultLinkRedirect&&t.preventDefaultLinkRedirectCallback&&t.preventDefaultLinkRedirectCallback.call(t,r));n.clicked=!0,t.__dispatchEvent("onStartSendClickParams",n);var o=t.sendHttpRequest("click",{data:t.buildClickParams(n,a)});o.always(function(){t.__dispatchEvent("onEndSendClickParams",o),t.preventDefaultLinkRedirect&&t.preventDefaultLinkRedirectCallback&&t.preventDefaultLinkRedirectCallback.call(t,r)})}},a.prototype.buildClickParams=function(e,t){var r=this,a={},n=$.extend(!0,{},e),o=t,i=r.cache.prolist;r.__dispatchEvent("onStartBuildClickParams",a,n),a.keyword=encodeURIComponent(r.keyword)||"",a.providerid=n.searchResultfoProviderid,a.userid=n.searchResultfoUserId||"0",a.bcid=n.searchResultfoId,a.p4punique=n.searchResultfoUnique||n.searchResultfoUnique,a.username=n.searchResultfoUserName,a.unitid=n.searchResultfoUnitId||0,a.planid=n.searchResultfoPlanId||0,a.price=n.searchResultfoUseBid||0,a.islike=n.searchResultfoMatchRule||0,a.sortpos=o+1,a.nextprice=i[o+1]&&i[o+1].searchResultfoUseBid||0,a.isnextlike=i[o+1]&&i[o+1].searchResultfoMatchRule||0,a.lastPrecisePrice=0,a.clickreferer=r.referrer,a.onekeytype=n.searchResultfoKypromote,a.nextonekeytype=i[o+1]&&i[o+1].searchResultfoKypromote,a.abtest=r.cache.searchResultfoGrayScale||0,a.pageid=window.PAGE_ID||window.HC&&window.HC.PAGE_ID;var c=o;if(0===parseInt(n.searchResultfoMatchRule))for(a.lastPrecisePrice=n.searchResultfoUseBid;++c<i.length;){if(0===parseInt(i[c].searchResultfoMatchRule)){a.lastPrecisePrice=i[c].searchResultfoUseBid;break}c++}else for(;c--;)if(0===parseInt(i[c].searchResultfoMatchRule)){a.lastPrecisePrice=i[c].searchResultfoUseBid;break}return r.__dispatchEvent("onAfterBuildClickParams",a,n,o),a},a.prototype.sendHttpRequest=function(e,t){var r=this;return $.ajax($.extend(!0,{},r.service[e]||{},t||{}))},a.prototype.sendExpoData=function(e){var t=this,r=("p4p-expo-iframe"+Math.random()).replace(/\.*/gi,"");if(e.length){if(!t.expo){var a=['<div data-node-name="p4p-expo-form-wrap" style="display:none;">','   <form action="http://log.org.hc360.com/logrecordservice/logrecordp4pexposure" enctype="application/x-www-form-urlencoded" method="post" target="#ifamename#">','       <input name="p4pexpolog" type="hidden">',"   </form>",'   <iframe name="#ifamename#"></iframe>',"</div>"],n=$(a.join("").replace(/\#ifamename\#/gi,r)).appendTo(t.wrap.length>1?t.wrap.first():t.wrap);$.extend(!0,t,{expo:{form:n.find("form"),input:n.find('input[type="hidden"]'),iframe:n.find("iframe"),data:[]}})}for(var o=[],i={},c=0;c<e.length;c++)$.inArray(e[c].searchResultfoId,t.expo.data)==-1&&(t.expo.data.push(e[c].searchResultfoId),i.params=[encodeURIComponent(t.keyword),e[c].searchResultfoId,e[c].searchResultfoPlanId||"",e[c].searchResultfoUnitId||"",e[c].searchResultfoUserId,e[c].searchResultfoProviderid,t.referrer,e[c].searchResultfoKypromote,window.PAGE_ID||window.HC&&window.HC.PAGE_ID,"0","0","0"],t.__dispatchEvent("onBuildExpoData",i,e[c]),o.push(i.params.join("@@")));t.__dispatchEvent("onStartSendExpoData",o),o.length&&(t.expo.input&&t.expo.input.val(o.join("#&#")),t.expo.form.length&&t.expo.form[0].submit())}},a.prototype.parseURL=function(e){var t=document.createElement("a");return t.href=e,{source:e,protocol:t.protocol.replace(":",""),host:t.hostname,port:t.port,query:t.search,params:function(){for(var e,r={},a=t.search.replace(/^\?/,"").split("&"),n=a.length,o=0;o<n;o++)a[o]&&(e=a[o].split("="),r[e[0]]=e[1]);return r}(),file:(t.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:t.hash.replace("#",""),path:t.pathname.replace(/^([^\/])/,"/$1"),relative:(t.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:t.pathname.replace(/^\//,"").split("/")}},a.prototype.resizeImage=function(e,t){function r(e,t,r,a,n){var o,i,c,l,s,p,u,d,h=0,f=0,m=a,g=n;void 0===e.data("owidth")&&e.data("owidth",t),void 0===e.data("oheight")&&e.data("oheight",r),m/g<e.data("owidth")/e.data("oheight")?(o="100%",i="auto",c=Math.floor(m),l=Math.floor(m*(e.data("oheight")/e.data("owidth")))):(o="auto",i="100%",c=Math.floor(g*(e.data("owidth")/e.data("oheight"))),l=Math.floor(g)),s="center",u=m-c,"left"===s&&(f=0),"center"===s&&(f=.5*u),"right"===s&&(f=u),s.indexOf("%")!==-1&&(s=parseInt(s.replace("%",""),10),s>0&&(f=u*s*.01)),p="center",d=g-l,"top"===p&&(h=0),"center"===p&&(h=.5*d),"bottom"===p&&(h=d),p.indexOf("%")!==-1&&(p=parseInt(p.replace("%",""),10),p>0&&(h=d*p*.01)),o=c,i=l,e.css({width:o,height:i,"margin-left":Math.floor(f),"margin-top":Math.floor(h)})}$.each(e,function(e,a){var n=a.src||"";if(n){var o=new Image;o.onload=function(){var e=$(a).parent();t&&(e=t.call(a)),r($(a),this.width,this.height,e.width(),e.height()),o=null},o.src=n}})},a.prototype.__getEventListener=function(e){var t=this;return t.listener[e]=t.listener[e]?t.listener[e]:[],t.listener[e]},a.prototype.__dispatchEvent=function(){for(var e=this,t=Array.prototype.shift.call(arguments),r=e.__getEventListener(t),a=0;a<r.length;a++)try{r[a].apply(e,arguments)}catch(n){}},a.prototype.removeEventListener=function(e,t){for(var r=this,a=r.__getEventListener(e),n=0;n<a.length;n++)t===a[n]&&a.splice(n--,1)},a.prototype.addEventListener=function(e,t){var r=this,a=[],n=e.split(",");$.each(n,function(e,n){return!$.trim(n).length||(a=r.__getEventListener(n),void a.push(t))})},e.exports=a}]);